args:
- default: true
  description: The hash value(s) to ban (comma-separated).
  name: hash
  required: true
comment: Deprecated. Use the cbp-fileRule-createOrUpdate command instead.
commonfields:
  id: CBPBanHash
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.0.0
    itemVersion: 1.0.29
    packID: CarbonBlackProtect
    packName: Carbon Black Enterprise Protection
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
dependson:
  must:
  - cbp-fileRule-createOrUpdate
deprecated: true
dockerimage: demisto/python:2.7.18.27799
engineinfo: {}
mainengineinfo: {}
name: CBPBanHash
pswd: ""
runas: DBotWeakRole
runonce: false
script: |
  register_module_line('CBPBanHash', 'start', __line__())



  CBP_HASH_BANNED = '3'
  res = []
  t = []
  for h in argToList(demisto.args()['hash']):
      e = demisto.executeCommand("cbp-fileRule-createOrUpdate", {"fileState": CBP_HASH_BANNED, "hash": h})[0]
      if isError(e):
          res += [e]
      else:
          t.append(e['Contents'])

  res.append({'ContentsFormat': formats['table'], 'Type': entryTypes['note'], 'Contents': t})
  demisto.results(res)

  register_module_line('CBPBanHash', 'end', __line__())
scripttarget: 0
subtype: python2
system: true
tags:
- carbon-black-protection
- bit9
type: python
