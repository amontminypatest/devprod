args:
- default: true
  description: ID of an active Carbon Black session
  name: sessionid
  required: true
comment: Deprecated. No available replacement.
commonfields:
  id: CBLiveProcessList
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.0.0
    itemVersion: 1.1.4
    packID: Carbon_Black_Enterprise_Live_Response
    packName: Carbon Black Enterprise Live Response
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
dependson:
  must:
  - cb-command-create
  - cb-command-info
deprecated: true
engineinfo: {}
mainengineinfo: {}
name: CBLiveProcessList
pswd: ""
runas: DBotWeakRole
runonce: false
script: |
  //Execute 'process list' command on a sensor
  //Args - sensor ID, session ID
  var output = [];
  var cmd = executeCommand("cb-command-create",{session: args.sessionid, wait: "true", name: "process list"});
  var id = cmd[0].Contents.id;
  var result = executeCommand("cb-command-info",{session: args.sessionid, command: id.toString()});
  output.push({ContentsFormat: formats.table, Type: entryTypes.note, Contents: result[0].Contents.processes});
  return output;
scripttarget: 0
system: true
tags:
- carbon-black
- endpoint
type: javascript
