comment: 'Example Splunk Post Processing script, you will likely need to change the
  field that contains the splunk notable event ID to make sure it can be closed. '
commonfields:
  id: 6f093bb4-f067-40e1-87d1-8dbaad0469b2
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: demisto/python:1.3-alpine
enabled: true
engineinfo: {}
mainengineinfo: {}
name: SplunkClosePostProcess
pswd: ""
runas: Administrator
runonce: false
script: |-
  # Post processing script for Splunk Notables
  # This is an example script, should work...

  # get close reason and notes
  notes = demisto.args().get('closeNotes')
  reason = demisto.args().get('closeReason')

  # get incident details
  inc = demisto.incidents()[0]
  demisto_id = inc.get('id')
  owner = inc.get('owner')

  # UPDATE THIS, depending on where you getting the notable id.
  splunkid = inc['CustomFields'].get('splunkeventid')

  comment = f"XSOAR Incident {demisto_id}: {notes}"
  status = 5

  demisto.executeCommand("splunk-notable-event-edit", {"eventIDs":splunkid,"comment":comment,"status":status,"owner":owner})
scripttarget: 0
subtype: python3
tags:
- post-processing
- training
timeout: 80ns
type: python
